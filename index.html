<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Äiá»u khiá»ƒn giá»ng nÃ³i</title>
</head>
<body>
  <h2>ğŸ™ï¸ Äiá»u khiá»ƒn thiáº¿t bá»‹ báº±ng giá»ng nÃ³i</h2>
  <button onclick="startRecognition()">ğŸ¤ Báº¯t Ä‘áº§u nÃ³i</button>
  <p id="status">ChÆ°a nÃ³i</p>

  <script>
    const ESP32_IP = "192.168.0.103"; // ğŸ‘‰ thay báº±ng IP ESP32 cá»§a báº¡n

    const commands = {
      "báº­t Ä‘Ã¨n 1": "bat den 1",
      "táº¯t Ä‘Ã¨n 1": "tat den 1",
      "báº­t Ä‘Ã¨n 2": "bat den 2",
      "táº¯t Ä‘Ã¨n 2": "tat den 2",
      "báº­t quáº¡t": "bat quat",
      "táº¯t quáº¡t": "tat quat",
      "má»Ÿ mÃ¡y chiáº¿u": "mo may chieu",
      "Ä‘Ã³ng mÃ¡y chiáº¿u": "dong may chieu",
      "má»Ÿ rÃ¨m": "mo rem",
      "Ä‘Ã³ng rÃ¨m": "dong rem"
    };

    function startRecognition() {
      const recognition = new webkitSpeechRecognition() || new SpeechRecognition();
      recognition.lang = "vi-VN";
      recognition.start();

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript.toLowerCase();
        document.getElementById("status").textContent = `ğŸ“¢ Báº¡n nÃ³i: ${transcript}`;

        if (commands[transcript]) {
          const cmd = commands[transcript];
          const url = `http://${ESP32_IP}/voice?cmd=${encodeURIComponent(cmd)}`;
          fetch(url)
            .then(response => response.text())
            .then(data => {
              document.getElementById("status").textContent += `\nâ¡ï¸ Lá»‡nh gá»­i: ${cmd}`;
            })
            .catch(error => {
              document.getElementById("status").textContent += `\nâŒ Lá»—i gá»­i lá»‡nh: ${error}`;
            });
        } else {
          document.getElementById("status").textContent += `\nâš ï¸ KhÃ´ng hiá»ƒu lá»‡nh nÃ y`;
        }
      };
    }
  </script>
</body>
</html>
